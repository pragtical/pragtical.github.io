"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[1484],{764:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>d,toc:()=>a});var t=i(5893),s=i(1151);const r={sidebar_position:8,description:"Learn how to interact with the OS, such as reading and writing to the clipboard, setting window properties and getting high-resolution time."},o="Interacting with the OS",d={id:"developer-guide/interacting-with-the-os",title:"Interacting with the OS",description:"Learn how to interact with the OS, such as reading and writing to the clipboard, setting window properties and getting high-resolution time.",source:"@site/docs/developer-guide/interacting-with-the-os.md",sourceDirName:"developer-guide",slug:"/developer-guide/interacting-with-the-os",permalink:"/docs/developer-guide/interacting-with-the-os",draft:!1,unlisted:!1,editUrl:"https://github.com/pragtical/pragtical.github.io/edit/main/docs/developer-guide/interacting-with-the-os.md",tags:[],version:"current",sidebarPosition:8,frontMatter:{sidebar_position:8,description:"Learn how to interact with the OS, such as reading and writing to the clipboard, setting window properties and getting high-resolution time."},sidebar:"tutorialSidebar",previous:{title:"Using Regular Expressions",permalink:"/docs/developer-guide/using-regular-expressions"},next:{title:"Child Processes",permalink:"/docs/developer-guide/child-processes"}},c={},a=[{value:"Using the System API",id:"using-the-system-api",level:2},{value:"Clipboard",id:"clipboard",level:3},{value:"File / Directory operations",id:"file--directory-operations",level:3},{value:"Timing",id:"timing",level:3},{value:"Window manipulation",id:"window-manipulation",level:2},{value:"Miscellaneous",id:"miscellaneous",level:2}];function l(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"interacting-with-the-os",children:"Interacting with the OS"}),"\n",(0,t.jsx)(n.p,{children:"This is where Pragtical's Lua code interact with its underlying C engine."}),"\n",(0,t.jsx)(n.h2,{id:"using-the-system-api",children:"Using the System API"}),"\n",(0,t.jsx)(n.p,{children:"There are many functions that belong to this API; not all are necessary for\nplugin development.\nAs such, we'll ignore them here and only document the useful ones."}),"\n",(0,t.jsx)(n.h3,{id:"clipboard",children:"Clipboard"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"system.set_clipboard()"})," sets the clipboard content,\nwhile ",(0,t.jsx)(n.code,{children:"system.get_clipboard()"})," retrieves the clipboard content."]}),"\n",(0,t.jsx)(n.p,{children:"The functions do not support rich content such as images and files."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"function system.set_clipboard(text: string): () end\nfunction system.get_clipboard(text: string): string end\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Examples:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'system.set_clipboard("wow magic")\n-- prints:\n-- wow magic\nprint(system.get_clipboard("wow magic"))\n'})}),"\n",(0,t.jsx)(n.h3,{id:"file--directory-operations",children:"File / Directory operations"}),"\n",(0,t.jsx)(n.p,{children:"These functions deal with files, directories and paths."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"-- Returns a list of files and directories in a directory.\nfunction system.list_dir(path: string): {string}, string end\n-- Creates a new directory.\nfunction system.mkdir(path: string): boolean, string end\n-- Removes a directory.\nfunction system.rmdir(path: string): boolean string end\n-- Changes the current working directory (equivalent to the `cd` command)\nfunction system.chdir(path: string): () end\n-- Resolves the input path (removing all '.' and '..') into an absolute path.\nfunction system.absolute_path(path: string): () end\n\n-- Types of paths\nlocal enum FileType\n  \"file\"\n  \"dir\"\nend\n\n-- The information for a path\nlocal record FileInfo\n  modified: number\n  size: number\n  type: FileType\n  symlink: boolean\nend\n\n-- Returns information for a file or a directory.\nfunction system.get_file_info(path: string): FileInfo, string end\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"system.get_file_info()"})," returns a table with the following properties:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"modified"}),": Modification time in seconds (UNIX timestamp)."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"size"}),": Size of the file in bytes."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"type"}),": Type of the path (Can be ",(0,t.jsx)(n.code,{children:"file"})," or ",(0,t.jsx)(n.code,{children:"dir"}),")."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"symlink"}),": The directory is a symlink (Only set on Linux and on directories)."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["All the functions listed above except ",(0,t.jsx)(n.code,{children:"system.chdir()"})," will return ",(0,t.jsx)(n.code,{children:"nil"}),"\nfollowed by an error message when an error occurred.\n",(0,t.jsx)(n.code,{children:"system.chdir()"})," will throw an error if an error occurred."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Examples:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'-- DO NOT RUN THIS CODE!\n-- the code and its outputs are purely for demonstration only,\n-- and will not reflect your actual usage.\nlocal dir = "../pragtical"\nlocal dir_resolved = system.absolute_path(dir)\n-- prints:\n-- /home/user/gh/pragtical\nprint(dir_resolved)\n\n-- prints:\n-- .git => dir\n-- docs => dir\n-- .editorconfig => file\n-- LICENSE => file\n-- ...\n-- pragtical => file\nfor i, d in ipairs(system.list_dir(dir_resolved)) do\n  local info = system.get_file_info(dir_resolved .. "/" .. d)\n  print(d .. " => " .. info.type)\nend\n\n-- create some directories\n-- this will not work because system.mkdir() doesn\'t create directories\n-- recursively, just like `mkdir` command without the `-p` option.\n-- prints:\n-- false   No such file or directory\nprint(system.mkdir(dir_resolved .. "/1/2"))\n\n-- these will work\n-- prints:\n-- true\nprint(system.mkdir(dir_resolved .. "/1"))\n-- prints:\n-- true\nprint(system.mkdir(dir_resolved .. "/1/2"))\n\n-- system.rmdir() does not support removing non-empty dirs, so\n-- this will not work and print an error\n-- prints:\n-- false   Directory not empty\nprint(system.rmdir(dir_resolved .. "/1"))\n\n-- instead, you should try to remove them recursively, making sure that each\n-- directory is empty\n-- prints:\n-- true\nprint(system.rmdir(dir_resolved .. "/1/2"))\n-- prints:\n-- true\nprint(system.rmdir(dir_resolved .. "/1"))\n'})}),"\n",(0,t.jsx)(n.h3,{id:"timing",children:"Timing"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"system.get_time()"})," returns time in seconds since Pragtical started.\nIt is a high-precision alternative to ",(0,t.jsx)(n.code,{children:"os.time()"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"function system.get_time(): number end\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Examples:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"-- prints:\n-- 30148.079763237\nprint(system.get_time())\n"})}),"\n",(0,t.jsx)(n.h2,{id:"window-manipulation",children:"Window manipulation"}),"\n",(0,t.jsx)(n.p,{children:"These functions deal with Pragtical window."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:'-- Sets the window opacity from 0 to 1.\nfunction system.set_window_opacity(opacity: number): boolean end\n-- Sets the window title.\nfunction system.set_window_title(title: string): () end\n\nlocal enum WindowMode\n  "normal"\n  "maximized"\n  "minimized"\n  "fullscreen"\nend\n\n-- Sets the window mode.\nfunction system.set_window_mode(mode: WindowMode): () end\n\n-- Enables/disables window borders (decoration).\nfunction system.set_window_bordered(enable: boolean): () end\n-- Sets the window hit test region.\nfunction system.set_window_hit_test(height?: number,\n                                    control_width?: number,\n                                    resize_border?: number): ()\nend\n-- Gets the window dimension and position.\nfunction system.get_window_size(): {number, number, number, number} end\n-- Sets the window dimension and position.\nfunction system.set_window_size(width:  number,\n                                height: number,\n                                x:      number,\n                                y:      number): ()\nend\n-- Checks whether windows has input focus.\nfunction system.window_has_focus(): boolean end\n-- Shows a message box with an error message.\nfunction system.show_fatal_error(title: string, msg: string): () end\n'})}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"height"})," parameter in ",(0,t.jsx)(n.code,{children:"system.set_window_hit_test()"})," refers to the height\nof the top decoration. Users can drag this part of the window to move it.\n",(0,t.jsx)(n.code,{children:"control_width"})," specifies the width of various window controls\n(minimize, maximize and close) buttons in the top right corner of the window.\n",(0,t.jsx)(n.code,{children:"resize_border"}),' specifies the width of a "border region" where users can\ndrag the window to resize it.\nThis value does not overlap with the ',(0,t.jsx)(n.code,{children:"height"})," parameter."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"system.get_window_size()"})," returns the width, height, x-coordinate\nand y-coordinate of the window respectively."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"system.set_window_opacity()"})," will return ",(0,t.jsx)(n.code,{children:"false"})," if the operation failed.\nOtherwise, it returns ",(0,t.jsx)(n.code,{children:"true"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"miscellaneous",children:"Miscellaneous"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"system.exec()"})," runs a command in the background.\nIt is useful if you just want to run a program and doesn't care about its\noutput and exit code.\nIf you want more features, consider using the ",(0,t.jsx)(n.a,{href:"/docs/developer-guide/child-processes",children:"Process API"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"system.fuzzy_match()"})," generates a score for sorting text based on relevance."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-lua",children:"function system.exec(command: string): () end\nfunction system.fuzzy_match(haystack: string,\n                            needle:   string,\n                            file:     boolean): number\nend\n"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"system.exec()"})," accepts a string containing a command to run.\nThis command will be run as ",(0,t.jsx)(n.code,{children:'system("<command> &")'})," on POSIX platforms and\n",(0,t.jsx)(n.code,{children:'cmd /c "<command>"'})," on Windows, so make sure that the command is escaped\nproperly."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"system.fuzzy_match()"})," takes in a ",(0,t.jsx)(n.code,{children:"haystack"})," (a possible match) and a ",(0,t.jsx)(n.code,{children:"needle"}),"\n(the string to search) to generate a similarity score.\nIf the score is 1, both strings are identical.\nWhen the third argument is ",(0,t.jsx)(n.code,{children:"true"}),", the matching will be done backwards as this\nis more suitable for matching paths."]})]})}function h(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},1151:(e,n,i)=>{i.d(n,{Z:()=>d,a:()=>o});var t=i(7294);const s={},r=t.createContext(s);function o(e){const n=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);